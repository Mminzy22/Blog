---
layout: post
title: "Machine Learning 23: k-최근접 이웃 회귀와 머신러닝 데이터 준비 과정"
date: 2024-12-10
categories: [Machine Learning]
---


### **1. 지도 학습의 이해: 분류와 회귀**


#### **1.1 지도 학습이란?**

지도 학습(Supervised Learning)은 머신러닝에서 **입력 데이터(Input)**와 이에 상응하는 **정답(Label)**을 사용해 모델을 학습시키는 방법입니다.  
이 과정에서 모델은 주어진 입력 데이터와 정답 간의 관계를 파악하여, **새로운 데이터에 대해 올바른 예측을 수행할 수 있도록 학습**합니다.


#### **1.2 분류(Classification)**

- **정의**: 주어진 입력 데이터를 미리 정의된 **카테고리(클래스)** 중 하나로 분류하는 문제입니다.  
  예를 들어, 스팸 이메일 필터링에서는 이메일이 **'스팸'** 또는 **'정상'** 중 하나로 분류됩니다.

- **특징**:
  - 출력 값(타깃)은 **이산적(Discrete)**입니다.
  - 모델은 각 입력 데이터가 특정 클래스에 속할 **확률**을 계산하며, 확률이 가장 높은 클래스를 선택합니다.

- **예시**:
  1. 스팸 메일 분류 (스팸/정상)
  2. 손글씨 숫자 이미지 분류 (0~9)
  3. 질병 진단 (양성/음성)

##### **코드 예제**: 분류 문제 데이터의 구조
```python
# 간단한 데이터 예시: 이메일 분류
emails = ["Win a free iPhone!", "Meeting at 10AM", "Buy cheap pills now!"]
labels = [1, 0, 1]  # 1: 스팸, 0: 정상
```


#### **1.3 회귀(Regression)**

- **정의**: 주어진 입력 데이터를 사용하여 **연속적(Continuous)**인 값을 예측하는 문제입니다.  
  예를 들어, 집 값 예측에서는 특정 입력 데이터(예: 위치, 면적)에 기반해 예상 집 값을 예측합니다.

- **특징**:
  - 출력 값(타깃)은 **연속적(Continuous)**입니다.
  - 모델은 숫자 데이터의 패턴을 학습하여, 입력 데이터에 대한 실수형 결과를 반환합니다.

- **예시**:
  1. 내년도 경제 성장률 예측 (예: 3.2%)
  2. 배달 도착 시간 예측 (예: 25분)
  3. 특정 제품의 판매량 예측 (예: 150개)

##### **코드 예제**: 회귀 문제 데이터의 구조
```python
# 간단한 데이터 예시: 배달 도착 시간 예측
features = [[2.5], [3.0], [4.2]]  # 배달 거리가 입력
labels = [15, 18, 25]  # 예측하려는 배달 시간(분)
```


#### **1.4 분류와 회귀의 차이점**

| **특징**          | **분류(Classification)**            | **회귀(Regression)**            |
|--------------------|--------------------------------------|----------------------------------|
| **출력 값**       | 이산적(범주형) 값                   | 연속적(숫자형) 값               |
| **목표**          | 특정 클래스에 속하는지 예측          | 입력 데이터로 임의의 수치 예측   |
| **예시**          | 스팸/정상 이메일 분류                | 내일의 온도 예측                |
| **평가 지표**     | 정확도(Accuracy), F1 Score           | 결정계수(\(R^2\)), 평균 절대 오차(MAE) |

##### **추가 팁**:
- **날씨 예측 문제**:  
  - 내일 "비가 올지 여부"를 예측한다면 → 분류 문제  
  - 내일 "비가 올 확률"을 예측한다면 → 회귀 문제  


#### **1.5 추가 설명: 분류와 회귀를 혼동하기 쉬운 사례**

1. **문제 정의의 중요성**:  
   같은 데이터를 사용하더라도 문제의 정의에 따라 분류 문제 또는 회귀 문제가 될 수 있습니다.  
   - 예를 들어, "학생 점수가 80점을 넘을 확률은?" → **회귀**  
   - "학생 점수가 80점을 넘을까?" → **분류**

2. **데이터 시각화의 도움**:  
   데이터를 시각화하면 문제의 본질을 더 쉽게 이해할 수 있습니다.
   - **군집처럼 보이는 데이터**는 분류 문제일 가능성이 높음.
   - **연속된 패턴을 보이는 데이터**는 회귀 문제일 가능성이 큼.

##### **코드 예제**: 데이터 시각화
```python
import matplotlib.pyplot as plt
import numpy as np

# 분류 데이터 예시
x = np.random.randn(100)
y = np.random.choice([0, 1], size=100)  # 이산적 출력
plt.scatter(x, y)
plt.title("분류 데이터 예시")
plt.show()

# 회귀 데이터 예시
x = np.linspace(0, 10, 100)
y = x + np.random.normal(0, 0.5, 100)  # 연속적 출력
plt.scatter(x, y)
plt.title("회귀 데이터 예시")
plt.show()
```
